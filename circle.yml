machine:
  php:
    version: 5.3.10
  environment:
   PATH: ${PATH}:${HOME}/${CIRCLE_PROJECT_REPONAME}/vendor/bin

dependencies:
  pre:
  # Update composer to the latest version.
  - sudo composer self-update
  # Install bats CLI testing.
  - sudo add-apt-repository ppa:duggan/bats --yes
  - sudo apt-get update -qq
  - sudo apt-get install -qq bats
  override:
  # Refresh environment variables.
  - phpenv rehash
  # Run installation of all dependencies unsing composer.
  - cd $HOME/$CIRCLE_PROJECT_REPONAME && composer install

test:
  override:
  # Run environment tests.
  - bats tests/bats/environment.bats
  # Run integration tests.
  - bats tests/bats/app.bats
  # Run unit tests.
  # @todo: Move this to the top once these tests implemented.
  - ./vendor/phpunit/phpunit/phpunit

